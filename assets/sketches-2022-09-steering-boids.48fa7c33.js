import"./index.7a991a0b.js";import{f as W,j as M,T as d,P as r,G as S,o as X,i as Y,a as F,t as G,r as V,p as l,m as _,b as Q,s as U,g as j,c as L,k as N,n as z,V as b}from"./Replay.c9641c9b.js";import{h as H,B as p,a as $}from"./Boid.f2683d21.js";import"./Wanderer.dda8626c.js";import{a as m,e as q,b as J,s as K,E as w,c as Z,T as E}from"./Expiration.8f722eed.js";import{S as O,s as ee,a as se,M as oe,b as te,F as ae,W as ne,A as ie,c as re,O as y,d as A,e as ce}from"./Asteroid.587dbd1d.js";import{p as de,a as le,b as pe,e as u}from"./PositionIndex.ce0183fb.js";import{b as me,c as ye,a as ue,d as xe,C as c,B as x,e as ge}from"./Bouncer.0116962f.js";import"./easings.d07c69a5.js";const g=W({x:d.f32,y:d.f32,threshold:d.f32}),he=M([g,r]),Se=(e=(s,o)=>{})=>{const s=new S(r),o=new S(g);return t=>{for(const n of he(t))X(n,s,o),Math.abs(s.x-o.x)<=o.threshold&&Math.abs(s.y-o.y)<=o.threshold&&e(t,n);return t}},f=10,be=50;async function fe(){const e=Y(),s=F();e.debug=!0;const o=new G.exports.Pane,t=o.addFolder({title:document.title,expanded:!0});e.addToPane(t);const n={historyPeriod:0,maxHistory:60*10,updateDelta:1e3/60};V(t,e,n);const B={entityQuery:M([m,O]),spawnEntity:Me,maxEntities:be,maxPerFrame:20,spawnDelay:.25},R={},C=a=>{N(e,E,a)||P(e,a)},T=(a,i)=>{P(a,i),z(a,i)},v=[];[375,275,175].forEach(a=>{let i=0;const I=Math.PI*2/f;for(let h=0;h<f;h++){i+=I*(1+(-.25+.5*Math.random()));const D=a*Math.cos(i),k=a*Math.sin(i);v.push(we(e,D,k))}}),Ee(e),e.run(l(K(B),J(),de(),ye(),ee(R),me(),_(),q(C),Se(T),Q(n),Pe({pane:o})),l(L(),j(),U([[p,$],[w,Z],[A,ce]])),s,l(ue(),le(),se(),ge())),Object.assign(window,{world:e,positionIndexService:pe,collisionService:xe,Collidable:c}),console.log("READY.")}const Pe=({pane:e})=>s=>(e.refresh(),s),Me=e=>{const s=Math.PI*2*Math.random(),o=800*Math.cos(s),t=800*Math.sin(s),n=H(Math.random(),1,.5);return p.spawn(e).add({Expiration:m,Steering:O,MaintainSpeed:oe,Seek:te,Flee:ae,Wander:ne,AvoidObstacles:ie,AvoidBorder:re,Obstacle:y,Collidable:c,AreaCircle:u,Bounce:x,GoalPosition:g}).set({MaintainSpeed:{maxSpeed:200,acceleration:10,braking:10},Seek:{force:10,x:0,y:0},Flee:{force:0,x:0,y:0},Wander:{force:5,distance:10,radius:10},AvoidObstacles:{force:20,range:75,radius:10,groups:[1],viewAngle:1.5},AvoidBorder:{force:50,originX:0,originY:0,marginX:75,marginY:75},Position:{x:o,y:t,r:0},GoalPosition:{x:0,y:0,threshold:50},Velocity:{x:50,y:0},SpriteOptions:{scaleX:.125,scaleY:.125,lineWidth:15,color:n},Expiration:{timeToLive:5+Math.random()*20},Obstacle:{groups:[1],radius:10},Collidable:{group:1},AreaCircle:{radius:10},Bounce:{mass:10}})},P=(e,s)=>w.spawn(e).add({Expiration:m,Tombstone:E}).set({Position:{x:r.x[s],y:r.y[s],r:0},Expiration:{timeToLive:1},Velocity:{x:b.x[s]/3,y:b.y[s]/3,r:0},SpriteOptions:{scaleX:.5,scaleY:.5,lineWidth:2}}),we=(e,s,o)=>A.spawn(e).add({Obstacle:y,Collidable:c,AreaCircle:u,Bounce:x}).set({Position:{x:s,y:o},Velocity:{r:Math.PI*(-.5+1*Math.random())},SpriteOptions:{scaleX:.5,scaleY:.5,lineWidth:3},Obstacle:{groups:[1],radius:25},Collidable:{group:1},AreaCircle:{radius:25},Bounce:{mass:1e3}}),Ee=(e,s,o)=>p.spawn(e).add({Obstacle:y,Collidable:c,AreaCircle:u,Bounce:x}).set({Position:{x:0,y:0,r:-Math.PI/2},Velocity:{x:0,y:0},SpriteOptions:{scaleX:.5,scaleY:.5,lineWidth:3,color:3407667},Obstacle:{groups:[1],radius:25},Collidable:{group:1},AreaCircle:{radius:25},Bounce:{mass:1e5}});fe().catch(console.error);

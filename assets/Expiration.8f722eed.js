var w=Object.defineProperty;var B=(e,t,s)=>t in e?w(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var S=(e,t,s)=>(B(e,typeof t!="symbol"?t+"":t,s),s);import{f as y,T as o,u as b,B as F,P as R,V,S as W,l as j,d as A,j as C,n as U}from"./Replay.c9641c9b.js";import{t as I,e as P}from"./easings.d07c69a5.js";const J=(e={})=>{let t=0;return s=>{const{entityQuery:n,spawnEntity:r,maxEntities:l=100,maxPerFrame:p=1,spawnDelay:c=0}=e,{deltaSec:m}=s.time;if(t-=m,t>0)return s;t=c;const d=n(s).length,a=Math.min(p,l-d);for(let f=0;f<a;f++)r(s);return s}},Y=10,u=25,k=y({numLines:o.ui8,timeElapsed:o.f32,angles:[o.f32,u],lineDurations:[o.f32,u],lineLengths:[o.f32,u],lineStarts:[o.f32,u],lineEnds:[o.f32,u]});class x extends F{static spawn(t,s={}){const n=j(Math.random,Y,u),r=[],l=[],p=[],c=[],m=[],d=[];for(let a=0;a<n;a++)r[a]=Math.random()*(Math.PI*2),l[a]=.5+.5*Math.random(),p[a]=0,c[a]=10+40*Math.random(),m[a]=10*Math.random(),d[a]=5+30*Math.random();return super.spawn(t,{ExplosionLines:{numLines:n,timeElapsed:0,angles:r,lineDurations:l,lineElapseds:p,lineLengths:c,lineStarts:m,lineEnds:d},...s})}update(){const{deltaSec:t}=this.world.time,{ExplosionLines:s}=this;s.timeElapsed+=t}}S(x,"components",{Position:R,Velocity:V,SpriteOptions:W,ExplosionLines:k}),S(x,"defaults",{SpriteOptions:{scaleX:1,scaleY:1,lineWidth:1,color:16777215}});class K extends A{draw(t,s){const{g:n}=this;super.draw(t,s);const{lineWidth:r,color:l}=s.SpriteOptions,{numLines:p,angles:c,timeElapsed:m,lineDurations:d,lineLengths:a,lineStarts:f,lineEnds:v}=s.ExplosionLines;for(let i=0;i<p;i++){const M=Math.cos(c[i]),g=Math.sin(c[i]),E=d[i],O=Math.min(E,m),h=I(f[i],v[i],E,O,P.easeOutQuart),T=h+a[i],D=I(1,0,E,O,P.easeOutQuart),N=M*h,Q=g*h,X=M*T,_=g*T;n.lineStyle(r,l,D),n.moveTo(N,Q),n.lineTo(X,_)}}update(t,s){this.draw(t,s),super.update(t,s)}}const Z=e=>t=>b(t,[[x]]),$=y(),L=y({timeToLive:o.f32}),q=C([L]),tt=(e=t=>{})=>t=>{const{deltaSec:s}=t.time;for(const n of q(t))L.timeToLive[n]-=s,L.timeToLive[n]<=0&&(e(n),U(t,n));return t};export{x as E,$ as T,L as a,Z as b,K as c,tt as e,J as s};
